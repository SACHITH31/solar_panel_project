<!DOCTYPE html>
<html>
  <head>
    <title>Solar Panel Efficiency</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="stylesheet" href="style.css" />
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <div class="dashboard-container">
      <!-- Header -->
      <header class="dashboard-header">
        <h2>GPREC EEE_BLOCK_1 SOLAR DATA</h2>
      </header>

      <!-- Filters / Controls -->
      <section class="controls-card">
        <input type="date" id="datePicker" />
        <button onclick="onDateSelect()" class="okButton">OK</button>

        <div id="status">
          <span class="live-dot"></span>
          <span>LIVE (auto-updating every 2 minutes)</span>
        </div>

        <div id="last_updated"></div>

        <button
          id="downloadBtn"
          class="download-btn btn"
          onclick="downloadDashboardSection()"
        >
          <span id="btnText">üìùDownload PDF</span>
        </button>

        <button id="monthViewBtn" class="download-btn">üìä Month View</button>

        <!-- <div class="date-nav-group">
          <button
            id="prevDateBtn"
            class="nav-date-btn"
            onclick="goToPreviousDate()"
          >
            <span class="icon">‚ü®</span>
            <span>Previous</span>
          </button>

          <input type="date" id="todayDisplay" class="static-date" disabled />

          <button
            id="nextDateBtn"
            class="nav-date-btn"
            onclick="goToNextDate()"
          >
            <span>Next</span>
            <span class="icon">‚ü©</span>
          </button>
        </div> -->
      </section>
      <div id="monthViewPopup" class="month-popup" style="display: none">
        <div class="tempCloseContainer" style="text-align: end">
          <div class="closeContainer">
            <span
              class="close-popup"
              onclick="closeMonthPopup()"
              style="font-size: 29px"
              >&times;</span
            >
          </div>
        </div>
        <div class="month-popup-content">
          <div class="month-controls">
            <div class="inputContainer">
              <label>Month:</label>
              <select id="mvMonth">
                <option value="1">January</option>
                <option value="2">February</option>
                <option value="3">March</option>
                <option value="4">April</option>
                <option value="5">May</option>
                <option value="6">June</option>
                <option value="7">July</option>
                <option value="8">August</option>
                <option value="9">September</option>
                <option value="10">October</option>
                <option value="11">November</option>
                <option value="12">December</option>
              </select>

              <label>Year:</label>
              <select id="mvYear"></select>

              <button id="mvOkBtn" class="okButton">OK</button>
            </div>

            <div
              id="monthLoader"
              style="display: none; text-align: center; margin: 20px 0"
            >
              <span>Loading monthly data...</span>
            </div>

            <div
              id="oopsMessage"
              style="
                display: none;
                color: #b91c1c;
                background: #fef2f2;
                padding: 8px;
                border-radius: 5px;
                margin-top: 10px;
                border: 1px solid #fecaca;
                text-align: center;
                font-weight: bold;
              "
            >
              ‚ö†Ô∏è Oops! No data available for this selected month.
            </div>

            <div
              id="monthlyBarChartContainer"
              style="display: none; margin-top: 20px"
            >
              <div
                id="monthlyBarChart"
                style="width: 100%; height: 450px"
              ></div>
            </div>
          </div>
        </div>
      </div>
      <!-- Main Chart -->
      <div id="download-area">
        <section class="chart-card">
          <div id="chart_div"></div>
        </section>

        <!-- Alerts / Legend -->
        <section class="info-cards">
          <div id="custom_legend" class="alert-card">
            <span class="alert-icon">‚ö†</span>
            <span
              >Sudden power drop detected (possible outage / inverter
              issue)</span
            >
          </div>
        </section>

        <!-- Summary Cards -->
        <section class="detailsCardContainer">
          <div id="live_watt" class="summary-card"></div>
          <div id="total_power" class="summary-card"></div>
          <div id="inverter-health" class="summary-card"></div>
          <div id="co2_saved" class="summary-card"></div>
        </section>

        <section class="metrics-table-card">
          <h3>Latest Inverter Metrics</h3>
          <table id="latestMetricsTable" class="metrics-table">
            <thead>
              <tr>
                <th>Parameter</th>
                <th>Latest Value</th>
              </tr>
            </thead>
            <tbody>
              <!-- rows will be filled from JS -->
            </tbody>
          </table>
        </section>
      </div>
      <!-- Events -->
      <section id="events" class="event-card">
        <div id="event-message">No error detections occurred.</div>
      </section>
    </div>

    <script src="script.js"></script>
  </body>
</html>
